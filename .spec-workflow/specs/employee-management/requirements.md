# Requirements Document

## Introduction

従業員管理ツールのWebアプリケーションのフロントエンド部分を開発します。このアプリケーションは会社の従業員情報、現場情報、およびそれらの関連付けを管理するためのツールです。React Nativeとmaterial-uiを使用して構築し、直感的で使いやすいユーザーインターフェースを提供します。

## Alignment with Product Vision

本システムは従業員と現場の効率的な管理を通じて、企業の業務効率化と情報の一元管理を実現します。CRUD操作を基本とした包括的な管理機能により、人事管理の複雑さを軽減し、情報の可視性を向上させます。

## Requirements

### Requirement 1: 従業員管理機能

**User Story:** 人事担当者として、従業員の基本情報を登録・更新・削除・参照できるようにしたい。これにより従業員データを一元管理し、効率的な人事業務を実現できる。

#### Acceptance Criteria

1. WHEN 新規従業員情報を入力して登録ボタンを押下 THEN システム SHALL 従業員データをデータベースに保存し、成功メッセージを表示する
2. WHEN 従業員一覧画面で従業員を選択して編集ボタンを押下 THEN システム SHALL 従業員情報編集画面を表示し、既存データを入力フィールドに設定する
3. WHEN 従業員情報を編集して保存ボタンを押下 THEN システム SHALL 更新されたデータを保存し、一覧画面に反映する
4. WHEN 従業員一覧画面で削除ボタンを押下 THEN システム SHALL 確認ダイアログを表示し、確認後にデータを削除する
5. IF 従業員が現場に配属されている THEN システム SHALL 削除を拒否し、警告メッセージを表示する

### Requirement 2: 現場管理機能

**User Story:** プロジェクトマネージャーとして、現場（プロジェクト）の情報を登録・更新・削除・参照できるようにしたい。これにより現場情報を適切に管理し、プロジェクトの進行状況を把握できる。

#### Acceptance Criteria

1. WHEN 新規現場情報を入力して登録ボタンを押下 THEN システム SHALL 現場データをデータベースに保存し、成功メッセージを表示する
2. WHEN 現場一覧画面で現場を選択して編集ボタンを押下 THEN システム SHALL 現場情報編集画面を表示し、既存データを入力フィールドに設定する
3. WHEN 現場情報を編集して保存ボタンを押下 THEN システム SHALL 更新されたデータを保存し、一覧画面に反映する
4. WHEN 現場一覧画面で削除ボタンを押下 THEN システム SHALL 確認ダイアログを表示し、確認後にデータを削除する
5. IF 現場に従業員が配属されている THEN システム SHALL 削除を拒否し、警告メッセージを表示する

### Requirement 3: 従業員と現場の紐づけ管理機能

**User Story:** 人事担当者として、従業員を現場に配属・配属解除・配属情報の参照ができるようにしたい。これにより適切な人員配置と配属状況の把握ができる。

#### Acceptance Criteria

1. WHEN 従業員選択フィールドで従業員を選択し、現場選択フィールドで現場を選択して配属ボタンを押下 THEN システム SHALL 配属関係をデータベースに保存し、成功メッセージを表示する
2. WHEN 配属一覧画面で配属関係を選択して解除ボタンを押下 THEN システム SHALL 確認ダイアログを表示し、確認後に配属関係を削除する
3. WHEN 配属一覧画面にアクセス THEN システム SHALL 全ての配属関係を従業員名と現場名で表示する
4. IF 従業員が既に同一現場に配属されている THEN システム SHALL 重複配属を拒否し、警告メッセージを表示する
5. WHEN 配属期間を指定して配属登録 THEN システム SHALL 開始日と終了日を含む配属情報を保存する

### Requirement 4: 情報参照・検索機能

**User Story:** 一般ユーザーとして、登録された従業員情報、現場情報、配属情報を効率的に検索・参照できるようにしたい。これにより必要な情報に素早くアクセスできる。

#### Acceptance Criteria

1. WHEN 従業員一覧画面で検索フィールドに名前の一部を入力 THEN システム SHALL 部分一致する従業員をリアルタイムで絞り込み表示する
2. WHEN 現場一覧画面で検索フィールドに現場名の一部を入力 THEN システム SHALL 部分一致する現場をリアルタイムで絞り込み表示する
3. WHEN 配属一覧画面でフィルター条件を設定 THEN システム SHALL 指定された条件に合致する配属情報のみを表示する
4. WHEN 従業員詳細画面にアクセス THEN システム SHALL 従業員の基本情報と現在の配属状況を表示する
5. WHEN 現場詳細画面にアクセス THEN システム SHALL 現場の基本情報と配属されている従業員一覧を表示する

### Requirement 5: 認証・認可機能

**User Story:** システム管理者として、Supabase認証を使用してユーザーのログイン・ログアウト・権限管理ができるようにしたい。これによりセキュアなアクセス制御を実現できる。

#### Acceptance Criteria

1. WHEN ログイン画面でメールアドレスとパスワードを入力してログインボタンを押下 THEN システム SHALL Supabase認証でユーザーを認証し、成功時にメイン画面にリダイレクトする
2. WHEN 未認証状態で保護されたページにアクセス THEN システム SHALL ログイン画面にリダイレクトする
3. WHEN ログアウトボタンを押下 THEN システム SHALL ユーザーセッションを終了し、ログイン画面にリダイレクトする
4. IF ユーザーが管理者権限を持たない THEN システム SHALL 管理者専用機能（削除等）を非表示にする
5. WHEN セッションが期限切れ THEN システム SHALL 自動的にログアウトし、ログイン画面にリダイレクトする

## Non-Functional Requirements

### Code Architecture and Modularity
- **Single Responsibility Principle**: 各コンポーネントは単一の責任を持ち、明確に定義された目的を果たす
- **Modular Design**: コンポーネント、ユーティリティ、サービスを独立性を保ちながら再利用可能な形で設計
- **Dependency Management**: モジュール間の相互依存性を最小限に抑制
- **Clear Interfaces**: コンポーネント間やレイヤー間で明確な契約を定義

### Performance
- ページ読み込み時間は3秒以内（3G回線）、1秒以内（WiFi接続）
- 1000件のデータ表示時でもスムーズなスクロールを実現
- 検索・フィルタリング操作は1秒以内で結果を表示
- バンドルサイズは初期読み込みで500KB以下、総計2MB以下

### Security
- Supabase認証による安全なユーザー認証
- APIアクセスにはJWTトークンによる認可を実装
- XSS、CSRF攻撃に対する適切な防御措置
- 機密情報のローカルストレージ保存禁止

### Reliability
- 99.9%のアップタイム目標
- データ保存時の適切なエラーハンドリング
- オフライン状態からの復旧機能
- データベース接続失敗時の適切なユーザー通知

### Usability
- WCAG 2.1 AA準拠のアクセシビリティ
- レスポンシブデザインによる多デバイス対応
- 直感的なナビゲーションとユーザーフレンドリーなUI
- 操作結果の明確なフィードバック（成功・エラーメッセージ）
- Material-UIによる一貫したデザインシステム

### Testing
- 単体テストカバレッジ100%を目標（vitest使用）
- E2Eテストによる主要ユーザージャーニーの検証
- 各機能の境界値テストとエラーケーステスト
- パフォーマンステストによる応答時間検証